{% extends 'base.html' %}
{% block content %}
<div class="card">
    <h3>Owner Dashboard</h3>
    <div class="mb-3">
        <a class="btn btn-primary-gradient me-2" href="{% url 'request_inspection' %}">Request Inspection</a>
        <a class="btn btn-danger-gradient me-2" href="{% url 'owner_complaint' %}">Submit Complaint</a>
        <a class="btn btn-secondary" href="{% url 'inbox' %}">Messages</a>
    </div>

    <table class="table table-striped mt-3">
        <thead>
            <tr>
                <th>Property</th>
                <th>Status</th>
                <th>Inspector</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for r in data %}
            <tr>
                <td>{{ r.building_location }}</td>
                <td>{{ r.status }}</td>
                <td>{% if r.inspector %}{{ r.inspector.get_full_name|default:r.inspector.username }}{% else %}Not Assigned{% endif %}</td>
                <td>
                    <a class="btn btn-primary-gradient btn-sm" href="{% url 'payment' r.id %}">Pay</a>
                    {% if r.report_obj %}
                        <a class="btn btn-sm btn-info ms-1" href="{% url 'view_report' r.report_obj.pk %}">View Report</a>
                        <a class="btn btn-sm btn-outline-primary ms-1" href="{% url 'download_report' r.report_obj.pk %}">Download</a>
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" class="text-center">No inspection requests yet.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}